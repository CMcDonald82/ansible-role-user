---

- hosts: localhost #all
  remote_user: root
  become: yes
  vars:
    system_users:
      # This user should be created and have sudo access
      - username: deploy_test_1
        password: admin
        groups:
          - sudo
        ssh_keys:
          - ./tests/files/id_rsa_test.pub
          - ./tests/files/id_rsa_test_2.pub

      # This user should not be created since it does not have 'ssh_keys' specified
      - username: deploy_test_2
        password: admin
        groups:
          - sudo

      # This user should be created but not have sudo privileges since it is not part of the sudo group
      - username: deploy_test_3
        password: admin
        ssh_keys:
          - ./tests/files/id_rsa_test.pub

      # # This user will be created then deleted
      # - username: deploy_user_4
      #   password: admin
      #   ssh_keys:
      #     - ./tests/files/id_rsa_test.pub

    # users_removed:
    #   - username: deploy_user_4
    #     remove: yes
    #     force: yes

  roles:
    - role_under_test

- hosts: localhost #all
  remote_user: root
  become: yes
  vars:
    system_users:
      # This user will be created then deleted
      - username: deploy_user_4
        password: admin
        ssh_keys:
          - ./tests/files/id_rsa_test.pub

    users_removed:
      - username: deploy_user_4
        remove: yes
        force: yes


